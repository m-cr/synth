"use strict";angular.module("synthApp",["ngAnimate","ngCookies","ngMessages","ngResource","ngRoute","ngSanitize","ngTouch"]).config(["$routeProvider",function(a){a.when("/",{templateUrl:"views/main.html",controller:"MainCtrl",controllerAs:"main"}).when("/about",{templateUrl:"views/about.html",controller:"AboutCtrl",controllerAs:"about"}).otherwise({redirectTo:"/"})}]),angular.module("synthApp").controller("MainCtrl",["$scope","Synth",function(a,b){var c={type:"square",types:["sine","square","sawtooth","triangle"],changeType:b.changeType,frequency:440,changeFrequency:b.changeFrequency,volume:b.volumeDisplay,changeVolume:function(a){b.changeVolume(a),this.volume=b.volumeDisplay}};a.osc=c,c.changeVolume(1);var d={type:"bandpass",types:["lowpass","highpass","bandpass","notch"],changeType:b.changeFilterType,step:function(a){return a/1e3},changeFrequency:b.changeFilterFrequency,frequency:500};a.filter=d;var e={changeRouting:b.changeLfoRouting,changeType:b.changeLfoType,dest:"volume",destOptions:["filter","volume"],rate:3,type:"sawtooth",changeRate:b.changeRate};a.lfo=e,a.effectTypes=["distortion","delay"],b.start()}]),angular.module("synthApp").factory("Synth",["$window",function(a){var b={},c=new a.AudioContext,d=c.createOscillator(),e=c.createGain(),f=c.createBiquadFilter();f.type="bandpass";var g=c.createBiquadFilter();f.frequency.value=1e3,g.frequency.value=5e3;var h=c.createGain();e.gain.value=.01,d.frequency.value=440,d.type="square";var i=c.createOscillator();i.frequency.value=3,i.type="sawtooth";var j=c.createGain();j.gain.value=.01;var k=c.createGain();return k.gain.value=500,i.connect(j),i.connect(k),d.connect(f),f.connect(e),e.connect(h),h.connect(c.destination),i.start(0),b.oscillator=d,b.gain=e,b.filter=f,b.start=function(){return b.volumeDisply=Math.floor(50*h.gain.value),d.start()},b.changeLfoRouting=function(a){"filter"===a?(i.disconnect(),j.disconnect(),i.connect(k),k.connect(f.frequency)):(i.disconnect(),k.disconnect(),i.connect(j),j.connect(e.gain))},b.changeLfoRouting("volume"),b.stop=function(){return d.stop()},b.changeFrequency=function(a){d.frequency.value=a},b.changeType=function(a){d.type=a},b.changeFilterType=function(a){f.type=a},b.changeLfoType=function(a){i.type=a},b.changeFilterFrequency=function(a){f.frequency.value=a},b.startOscillator=function(){d.start()},b.changeVolume=function(a){h.gain.value=a,b.volumeDisplay=Math.floor(50*a),console.log("synthfactory.volumeDisplay",b.volumeDisplay)},b.changeRate=function(a){i.frequency.value=a},b}]),angular.module("synthApp").run(["$templateCache",function(a){a.put("views/main.html",'<div class="well"> <div class="pull-right"> <button ng-show="volume !== 0" class="btn btn-default" ng-click="osc.changeVolume(0); oldVolume = volume; volume=0;" type="submit">Mute</button> <button ng-show="volume === 0" class="btn btn-default" ng-click="osc.changeVolume(oldVolume); volume = oldVolume;" type="submit">Un-mute</button> </div> <h3>Oscillator</h3> <p>Volume: {{ osc.volume }}</p> <input type="range" min="0" max="3" value="{{ osc.volume }}" step=".005" ng-model="volume" ng-change="osc.changeVolume(volume)"> <br> <p>Type: {{osc.type}}</p> <select ng-model="type" ng-options="t for t in osc.types" ng-change="osc.changeType(type)"></select> <br><br> <p>Oscillator Frequency: {{osc.frequency}}</p> <input type="range" min="20" max="1000" value="{{osc.frequency}}" step="1" ng-model="frequency" ng-change="osc.changeFrequency(frequency)"> <br> </div> <div class="well"> <h3>Filter</h3> <p>Type: {{filter.type}}</p> <select ng-model="filter.type" ng-options="t for t in filter.types" ng-change="filter.changeType(filter.type)"></select> <br><br> <p>Filter Frequency: {{filter.frequency}}</p> <input type="range" min="20" max="5000" value="{{filter.frequency}}" step="1" ng-model="filter.frequency" ng-change="filter.changeFrequency(filter.frequency)"> </div> <div class="well"> <h3>LFO</h3> <p>Destination: {{lfo.dest}} </p> <select ng-model="lfo.dest" ng-options="d for d in lfo.destOptions" ng-change="lfo.changeRouting(lfo.dest)"></select> <br> <p>Rate: {{lfo.rate}} </p> <input type="range" min="0" max="100" value="{{lfo.rate}}" step="1" ng-model="lfo.rate" ng-change="lfo.changeRate(lfo.rate)"> <br> <p>Type: {{lfo.type}}</p> <select ng-model="lfo.type" ng-options="t for t in osc.types" ng-change="lfo.changeType(lfo.type)"></select> <br> </div>')}]);